-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.actor
(
    id_actor integer NOT NULL,
    actor text COLLATE pg_catalog."default",
    CONSTRAINT actor_pkey PRIMARY KEY (id_actor)
);

CREATE TABLE IF NOT EXISTS public.cintas
(
    id_cinta integer NOT NULL,
    id_peli integer,
    fecha date,
    CONSTRAINT cintas_pkey PRIMARY KEY (id_cinta)
);

CREATE TABLE IF NOT EXISTS public.director
(
    id_director integer NOT NULL,
    director text COLLATE pg_catalog."default",
    CONSTRAINT director_pkey PRIMARY KEY (id_director)
);

CREATE TABLE IF NOT EXISTS public.genero
(
    id_genero integer NOT NULL,
    genero text COLLATE pg_catalog."default",
    CONSTRAINT genero_pkey PRIMARY KEY (id_genero)
);

CREATE TABLE IF NOT EXISTS public.lista_de_espera
(
    id_peli integer,
    id_socio integer
);

CREATE TABLE IF NOT EXISTS public.peli_actores
(
    id_peli integer,
    id_actor integer
);

CREATE TABLE IF NOT EXISTS public.peli_directores
(
    id_peli integer,
    id_director integer
);

CREATE TABLE IF NOT EXISTS public.peli_genero
(
    id_peli integer,
    id_genero integer
);

CREATE TABLE IF NOT EXISTS public.peliculas
(
    titulo text COLLATE pg_catalog."default" NOT NULL,
    id_peli integer NOT NULL,
    CONSTRAINT peliculas_pkey PRIMARY KEY (id_peli)
);

CREATE TABLE IF NOT EXISTS public.renta_cinta
(
    id_cinta integer,
    id_socio integer
);

CREATE TABLE IF NOT EXISTS public.socio
(
    id_socio integer NOT NULL,
    nombre text COLLATE pg_catalog."default",
    direccion text COLLATE pg_catalog."default",
    telefono integer,
    CONSTRAINT socio_pkey PRIMARY KEY (id_socio)
);

CREATE TABLE IF NOT EXISTS public.socio_actores
(
    id_socio integer,
    id_actor integer
);

CREATE TABLE IF NOT EXISTS public.socio_directores
(
    id_socio integer,
    id_director integer
);

CREATE TABLE IF NOT EXISTS public.socio_genero
(
    id_socio integer,
    id_genero integer
);

ALTER TABLE IF EXISTS public.cintas
    ADD CONSTRAINT cintas_id_peli_fkey FOREIGN KEY (id_peli)
    REFERENCES public.peliculas (id_peli) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.lista_de_espera
    ADD CONSTRAINT lista_de_espera_id_peli_fkey FOREIGN KEY (id_peli)
    REFERENCES public.peliculas (id_peli) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.lista_de_espera
    ADD CONSTRAINT lista_de_espera_id_socio_fkey FOREIGN KEY (id_socio)
    REFERENCES public.socio (id_socio) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.peli_actores
    ADD CONSTRAINT peli_actores_id_actor_fkey FOREIGN KEY (id_actor)
    REFERENCES public.actor (id_actor) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.peli_actores
    ADD CONSTRAINT peli_actores_id_peli_fkey FOREIGN KEY (id_peli)
    REFERENCES public.peliculas (id_peli) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.peli_directores
    ADD CONSTRAINT peli_directores_id_peli_fkey FOREIGN KEY (id_peli)
    REFERENCES public.peliculas (id_peli) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.peli_directores
    ADD FOREIGN KEY (id_director)
    REFERENCES public.director (id_director) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.peli_genero
    ADD CONSTRAINT peli_genero_id_genero_fkey FOREIGN KEY (id_genero)
    REFERENCES public.genero (id_genero) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.peli_genero
    ADD CONSTRAINT peli_genero_id_peli_fkey FOREIGN KEY (id_peli)
    REFERENCES public.peliculas (id_peli) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.renta_cinta
    ADD CONSTRAINT renta_cinta_id_cinta_fkey FOREIGN KEY (id_cinta)
    REFERENCES public.cintas (id_cinta) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.socio_actores
    ADD CONSTRAINT socio_actores_id_actor_fkey FOREIGN KEY (id_actor)
    REFERENCES public.actor (id_actor) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.socio_actores
    ADD CONSTRAINT socio_actores_id_socio_fkey FOREIGN KEY (id_socio)
    REFERENCES public.socio (id_socio) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.socio_directores
    ADD CONSTRAINT socio_directores_id_director_fkey FOREIGN KEY (id_director)
    REFERENCES public.director (id_director) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.socio_directores
    ADD CONSTRAINT socio_directores_id_socio_fkey FOREIGN KEY (id_socio)
    REFERENCES public.socio (id_socio) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.socio_genero
    ADD CONSTRAINT socio_genero_id_genero_fkey FOREIGN KEY (id_genero)
    REFERENCES public.genero (id_genero) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.socio_genero
    ADD CONSTRAINT socio_genero_id_socio_fkey FOREIGN KEY (id_socio)
    REFERENCES public.socio (id_socio) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;

END;
